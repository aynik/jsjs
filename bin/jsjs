#!/usr/bin/env node
var fs = require('fs');

var program = require('commander')
  .version(require('../package').version)
  .usage('[options] file [..files]')
  .option('-t, --tab [prefix]', 'tabulate output with selected prefix')
  .option('-c, --compress', 'drop unnecessary white space')
  .parse(process.argv);

program.args.map(function(src){
   fs.readFile(src, function(err, data){
       if (err) return console.log(err);
       var source = data.toString();
       if (source.substr(0,1) === "#"){
           source = source.substr(
               source.indexOf('\n')+1, source.length);
       }
       console.log(require('../').read(source, program));
   });
});
